/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as t,jsxs as s,Fragment as V}from"@dropins/tools/preact-jsx-runtime.js";import{classes as b,VComponent as k}from"@dropins/tools/lib.js";/* empty css                 */import{Skeleton as W,SkeletonRow as Z,Input as E,Picker as J,Price as N,Checkbox as K,Button as U,Table as X,Accordion as Y,AccordionSection as C}from"@dropins/tools/components.js";import{h as Q}from"@dropins/tools/preact.js";import{useState as H,useEffect as ee}from"@dropins/tools/preact-hooks.js";import{g as te}from"./dateUtils.js";import{useText as ae}from"@dropins/tools/i18n.js";const me=({className:g,loading:c,table:r,pricesSummary:i,...n})=>c?t(oe,{}):s("div",{className:b(["quote-management-items-quoted",g]),...n,children:[r&&t(k,{node:r,className:b(["quote-management-items-quoted__table"]),"data-testid":"quote-management-items-quoted__table"}),i&&t(k,{node:i,className:b(["quote-management-items-quoted__prices-summary"]),"data-testid":"quote-management-items-quoted__prices-summary"})]}),oe=()=>t(W,{"data-testid":"items-quoted-skeleton",children:t(Z,{variant:"row",fullWidth:!0,size:"medium",lines:4,multilineGap:"xsmall"})}),pe=({className:g,items:c,canEdit:r,readOnly:i=!1,onItemCheckboxChange:n,onItemDropdownChange:m,onQuantityChange:p,onUpdate:h,dropdownSelections:y,...T})=>{const[M,x]=H({}),[v,L]=H({});ee(()=>{const e={};c.forEach(o=>{e[o.uid]=o.quantity}),x(e),L(e)},[c]);const S=Object.keys(v).some(e=>v[e]!==M[e]),u=ae({updateButton:"NegotiableQuote.Manage.productListTable.submitButton",productNameHeader:"NegotiableQuote.Manage.productListTable.headers.productName",skuHeader:"NegotiableQuote.Manage.productListTable.headers.sku",priceHeader:"NegotiableQuote.Manage.productListTable.headers.price",quantityHeader:"NegotiableQuote.Manage.productListTable.headers.quantity",discountHeader:"NegotiableQuote.Manage.productListTable.headers.discount",subtotalHeader:"NegotiableQuote.Manage.productListTable.headers.subtotal",actionsHeader:"NegotiableQuote.Manage.productListTable.headers.actions",editNoteToSeller:"NegotiableQuote.Manage.productListTable.actions.editNoteToSeller",remove:"NegotiableQuote.Manage.productListTable.actions.remove",notesHeader:"NegotiableQuote.Manage.productListTable.notes.header",leftANote:"NegotiableQuote.Manage.productListTable.notes.leftANote",buyer:"NegotiableQuote.Manage.productListTable.notes.buyer"}),f=[{label:u.productNameHeader,key:"productName"},{label:u.skuHeader,key:"sku"},{label:u.priceHeader,key:"price"},{label:u.quantityHeader,key:"quantity"},{label:u.discountHeader,key:"discount"},{label:u.subtotalHeader,key:"subtotal"}];r&&!i&&(f.unshift({label:"",key:"checkbox"}),f.push({label:u.actionsHeader,key:"actions"}));const P=(e,o)=>{const a=e.target.checked;n==null||n(o,a)},w=(e,o)=>{const a=e.target.value;m==null||m(o,a)},$=(e,o)=>{const a=parseInt(e.target.value,10);!isNaN(a)&&a>0&&(L(d=>({...d,[o.uid]:a})),p==null||p(o,a))},B=e=>{e.preventDefault(),h==null||h(e)},A=(e,o)=>e>0?s("div",{className:"quote-management-product-list-table__discount-container",children:[s("span",{className:"quote-management-product-list-table__discount-percent",children:[o,"%"]}),s("span",{className:"quote-management-product-list-table__discount-price",children:["(",t(N,{amount:e}),")"]})]}):void 0,O=e=>{var d,_;const o=(d=e.configurableOptions)==null?void 0:d.map(l=>s("div",{className:"quote-management-product-list-table__configurable-option",children:[s("span",{className:"quote-management-product-list-table__configurable-option-label",children:[l.optionLabel,":"]}),t("span",{className:"quote-management-product-list-table__configurable-option-value",children:l.valueLabel})]},l.optionLabel)),a=(_=e.bundleOptions)==null?void 0:_.map(l=>s("div",{className:"quote-management-product-list-table__bundle-option",children:[t("span",{className:"quote-management-product-list-table__bundle-option-label",children:l.label}),t("div",{className:"quote-management-product-list-table__bundle-option-values",children:l.values.map(q=>s("span",{className:"quote-management-product-list-table__bundle-option-value",children:[s("span",{className:"quote-management-product-list-table__bundle-option-value-quantity",children:[q.quantity," x"]}),t("span",{className:"quote-management-product-list-table__bundle-option-value-label",children:q.label}),t(N,{className:"quote-management-product-list-table__bundle-option-value-original-price",amount:q.originalPrice.value,currency:q.originalPrice.currency,weight:"normal"})]},q.label))})]},l.label));return s("div",{className:"quote-management-product-list-table__product-name-container",children:[t("span",{className:"quote-management-product-list-table__product-name",children:e.product.name}),o,a]})},F=e=>new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0,timeZone:te()}),R=e=>{if(!e.noteFromBuyer||e.noteFromBuyer.length===0)return null;const o=e.noteFromBuyer.filter(a=>a&&a.note&&a.note.trim()!=="");return o.length===0?null:s("div",{className:"quote-management-product-list-table__notes-container","data-testid":`item-notes-${e.product.sku}`,children:[t("div",{className:"quote-management-product-list-table__notes-header",children:u.notesHeader}),t("div",{className:"quote-management-product-list-table__notes-list",children:o.map((a,d)=>s("div",{className:"quote-management-product-list-table__note-item",children:[s("div",{className:"quote-management-product-list-table__note-content",children:[s("strong",{className:"quote-management-product-list-table__note-meta",children:[F(a.createdAt)," (",u.buyer,")"]})," ",u.leftANote]}),s("div",{className:"quote-management-product-list-table__note-text",children:[a.note," "]})]},a.noteUid||d))})]})},j=c.flatMap(e=>{var _;const o=r?t(E,{className:"quote-management-product-list-table__quantity-input",type:"number",min:"1",value:((_=v[e.uid])==null?void 0:_.toString())||e.quantity.toString(),onChange:l=>$(l,e),disabled:i||!r,"data-testid":`quantity-input-${e.product.sku}`}):t("span",{className:"quote-management-product-list-table__quantity",children:e.quantity}),a={checkbox:t(K,{className:"quote-management-product-list-table__checkbox",name:"itemSelected","data-testid":`item-checkbox-${e.product.sku}`,onChange:l=>P(l,e),value:e.product.sku}),productName:O(e),sku:t("span",{className:"quote-management-product-list-table__sku",children:e.product.sku}),price:t(N,{className:"quote-management-product-list-table__price",amount:e.prices.originalItemPrice.value,currency:e.prices.originalItemPrice.currency}),quantity:o,discount:e.catalogDiscount?A(e.catalogDiscount.amountOff,e.catalogDiscount.percentOff):void 0,subtotal:t(N,{className:"quote-management-product-list-table__subtotal",amount:e.prices.rowTotal.value,currency:e.prices.rowTotal.currency}),actions:t(J,{className:"quote-management-product-list-table__actions","data-testid":`item-dropdown-${e.product.sku}`,name:`item-dropdown-${e.product.sku}`,handleSelect:l=>w(l,e),placeholder:"Select",value:(y==null?void 0:y[e.uid])??"",options:[{text:u.editNoteToSeller,value:"edit"},{text:u.remove,value:"remove"}]})},d=R(e);return d?[a,{checkbox:"",productName:t("div",{className:"quote-management-product-list-table__notes-row-wrapper",children:d}),sku:"",price:"",quantity:"",discount:"",subtotal:"",actions:""}]:[a]}),D=t(X,{columns:f,rowData:j,"data-testid":"product-list-table",mobileLayout:"stacked"}),z=r?Q("form",{}):Q("div",{}),G=r?{onSubmit:B,...T}:T,I=t(U,{type:"submit",disabled:i||!r||!S,"data-testid":"product-list-table-submit-button",children:u.updateButton});return s(k,{node:z,className:b(["quote-management-product-list-table-container",g]),"data-testid":"product-list-table-container",...G,children:[D,t("div",{className:"quote-management-product-list-table-container__submit-container",children:I})]})},be=({className:g,entries:c,...r})=>{const i=n=>{var p;const m=(p=n.children)==null?void 0:p.map(i);return t("div",{className:"quote-management-quote-prices-summary__entry","data-testid":`quote-prices-summary-entry-${n.id}`,children:m?t(Y,{className:"quote-management-quote-prices-summary__accordion","data-testid":`quote-prices-summary-entry-accordion-${n.id}`,children:t(C,{className:"quote-management-quote-prices-summary__accordion-section",title:n.label,ariaLabelTitle:n.label,secondaryText:n.value,children:m})}):s(V,{children:[t("span",{className:b(["quote-management-quote-prices-summary__label",["quote-management-quote-prices-summary__label--strong",n.strong]]),"data-testid":`quote-prices-summary-entry-label-${n.id}`,children:n.label}),t("span",{className:"quote-management-quote-prices-summary__value","data-testid":`quote-prices-summary-entry-value-${n.id}`,children:n.value})]})},n.id)};return t("div",{className:b(["quote-management-quote-prices-summary",g]),"data-testid":"quote-prices-summary",...r,children:c==null?void 0:c.map(i)})};export{me as I,pe as P,be as Q};
//# sourceMappingURL=QuotePricesSummary.js.map
