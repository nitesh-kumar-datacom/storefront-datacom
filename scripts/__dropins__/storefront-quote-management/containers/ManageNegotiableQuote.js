/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as a,jsxs as d,Fragment as Xe}from"@dropins/tools/preact-jsx-runtime.js";import*as Ge from"@dropins/tools/preact-compat.js";import{useState as l,useRef as pe,useEffect as S,useCallback as c,useMemo as p,createPortal as B}from"@dropins/tools/preact-compat.js";import{classes as s,VComponent as b,Slot as u}from"@dropins/tools/lib.js";import{f as $e}from"../chunks/dateUtils.js";/* empty css                         */import{Skeleton as La,SkeletonRow as k,Modal as Ra,Input as xa,TextArea as Je,Button as A,InLineAlert as h}from"@dropins/tools/components.js";import{events as D}from"@dropins/tools/event-bus.js";import{A as Ha,T as Fa}from"../chunks/TabbedContent.js";import"@dropins/tools/preact.js";import"@dropins/tools/preact-hooks.js";import{C as W}from"../chunks/ConfirmationModal.js";/* empty css                        *//* empty css                                  *//* empty css                          */import{useText as Ke}from"@dropins/tools/i18n.js";import{S as Ba}from"../chunks/ShippingAddressDisplay.js";import{Q as ka}from"../chunks/QuoteHistoryLog3.js";import{g as Ua,r as Oa,c as za,a as Pa,s as Wa,d as Va,b as ja}from"../chunks/duplicateNegotiableQuote.js";import"../chunks/state.js";import{I as Ga}from"../chunks/ItemsQuoted.js";import{Q as $a}from"../chunks/QuoteCommentsList3.js";import{a as U,S as V}from"../chunks/WarningFilled.js";import"../chunks/QuoteHistoryLog.js";import"../chunks/transform-quote.js";import"@dropins/tools/fetch-graphql.js";import"../chunks/NegotiableQuoteFragment.js";import"../chunks/transform-quote-template.js";import"../chunks/NegotiableQuoteTemplateFragment.js";import"../chunks/QuotePricesSummary.js";import"../chunks/setLineItemNote.js";import"../chunks/QuoteCommentsList.js";const Xa=N=>Ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-edit-2",...N},Ge.createElement("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})),Ja=({className:N,loading:t,quoteName:m,quoteStatus:C,banner:q,details:I,actionBar:e,quoteContent:f,shippingInformationTitle:T,shippingInformation:y,quoteCommentsTitle:E,quoteComments:_,footer:Q,...M})=>t?a(Ka,{}):d("div",{...M,className:s(["quote-management-manage-negotiable-quote",N]),children:[d("div",{className:s(["quote-management-manage-negotiable-quote__header"]),children:[m&&a(b,{node:m,className:s(["quote-management-manage-negotiable-quote__quote-name"])}),C&&a(b,{node:C,className:s(["quote-management-manage-negotiable-quote__quote-status"])})]}),q&&a(b,{node:q,className:s(["quote-management-manage-negotiable-quote__banner"])}),I&&a(b,{node:I,className:s(["quote-management-manage-negotiable-quote__details"])}),e&&a(b,{node:e,className:s(["quote-management-manage-negotiable-quote__action-bar"])}),f&&a(b,{node:f,className:s(["quote-management-manage-negotiable-quote__quote-content"])}),d("div",{"data-testid":"quote-shipping-information-container",className:s(["quote-management-manage-negotiable-quote__shipping-information-container"]),children:[T&&a(b,{node:T,className:s(["quote-management-manage-negotiable-quote__shipping-information-title"])}),y&&a(b,{node:y,className:s(["quote-management-manage-negotiable-quote__shipping-information"])})]}),d("div",{"data-testid":"quote-comments-container",className:s(["quote-management-manage-negotiable-quote__quote-comments-container"]),children:[E&&a(b,{node:E,className:s(["quote-management-manage-negotiable-quote__quote-comments-title"])}),_&&a(b,{node:_,className:s(["quote-management-manage-negotiable-quote__quote-comments"])})]}),a(b,{node:Q,className:s(["quote-management-manage-negotiable-quote__footer"])})]}),Ka=()=>d(La,{"data-testid":"manage-negotiable-quote-skeleton",children:[a(k,{variant:"heading",fullWidth:!0,size:"large"}),a(k,{variant:"row",fullWidth:!1,size:"small"}),a(k,{variant:"row",fullWidth:!1,size:"small"}),a(k,{variant:"row",fullWidth:!0}),a(k,{variant:"row",fullWidth:!0,size:"xlarge",lines:2}),a(k,{variant:"row",fullWidth:!1,size:"small"})]}),Ya=({className:N,open:t,quoteName:m,renameReason:C,quoteNameError:q,errorBanner:I,successBanner:e,showCloseButton:f=!0,onQuoteNameChange:T,onRenameReasonChange:y,onSave:E,onClose:_})=>{const Q=Ke({title:"NegotiableQuote.Manage.rename.title",quoteNameLabel:"NegotiableQuote.Manage.rename.quoteNameLabel",reasonLabel:"NegotiableQuote.Manage.rename.reasonLabel",renameButton:"NegotiableQuote.Manage.rename.renameButton",cancelButton:"NegotiableQuote.Manage.rename.cancelButton"});return t?d(Ra,{open:t,size:"medium",title:a(Xe,{children:Q.title}),onClose:_,clickToDismiss:!0,escapeToDismiss:!0,showCloseButton:f,className:s(["quote-management-rename-quote-modal",N]),"data-testid":"rename-quote-modal",children:[I&&a("div",{className:s(["quote-management-rename-quote-modal__error-banner"]),"data-testid":"rename-quote-modal-error-banner",children:I}),e&&a("div",{className:s(["quote-management-rename-quote-modal__success-banner"]),"data-testid":"rename-quote-modal-success-banner",children:e}),d("div",{className:s(["quote-management-rename-quote-modal__content"]),children:[d("div",{children:[a(xa,{name:"quoteName",type:"text",value:m,onInput:M=>T(M.target.value),floatingLabel:Q.quoteNameLabel,required:!0,error:!!q}),q&&a("span",{className:s(["quote-management-rename-quote-modal__error-text"]),children:q})]}),a(Je,{name:"quoteComment",value:C,onInput:M=>y(M.target.value),label:Q.reasonLabel,rows:3})]}),d("div",{className:s(["quote-management-rename-quote-modal__actions"]),children:[a(A,{variant:"secondary",size:"medium",onClick:_,className:s(["quote-management-rename-quote-modal__cancel-button"]),children:Q.cancelButton}),a(A,{variant:"primary",size:"medium",onClick:E,className:s(["quote-management-rename-quote-modal__save-button"]),children:Q.renameButton})]})]}):null},Lt=({onActionsDropdownChange:N,slots:t,onActionsButtonClick:m,onSendForReview:C,onDuplicateQuote:q,...I})=>{const[e,f]=l(void 0),[T,y]=l(!0),[E,_]=l(!1),[Q,M]=l(null),[Ye,j]=l(!1),[fe,ee]=l(!1),[Me,w]=l(null),[Ze,R]=l(!1),[L,be]=l(""),[O,ae]=l(!1),[he,te]=l(!1),[Ne,ne]=l(!1),[qe,x]=l(""),[Qe,z]=l(""),[Se,Te]=l(!1),[ve,Ce]=l(!1),[ye,G]=l(""),[_e,$]=l(""),[De,oe]=l(!1),[X,J]=l(""),[re,K]=l(""),[ie,P]=l(""),[Ae,H]=l(""),[le,Y]=l(""),[ce,Ie]=l(new Set),Ee=pe(ce),se=pe(null),[F,me]=l(""),Z=pe(F),[we,Le]=l(!1);S(()=>{Ee.current=ce},[ce]),S(()=>{Z.current=F},[F]);const o=Ke({createdLabel:"NegotiableQuote.Manage.createdLabel",salesRepLabel:"NegotiableQuote.Manage.salesRepLabel",expiresLabel:"NegotiableQuote.Manage.expiresLabel",actionsLabel:"NegotiableQuote.Manage.actionsLabel",remove:"NegotiableQuote.Manage.actions.remove",close:"NegotiableQuote.Manage.actionButtons.close",delete:"NegotiableQuote.Manage.actionButtons.delete",print:"NegotiableQuote.Manage.actionButtons.print",createTemplate:"NegotiableQuote.Manage.actionButtons.createTemplate",createCopy:"NegotiableQuote.Manage.actionButtons.createCopy",shippingInformationTitle:"NegotiableQuote.Manage.shippingInformation.title",quoteCommentsTitle:"NegotiableQuote.Manage.quoteComments.title",quoteCommentsPlaceholder:"NegotiableQuote.Manage.quoteComments.placeholder",sendForReview:"NegotiableQuote.Manage.actionButtons.sendForReview",bannerTitle:"NegotiableQuote.Manage.bannerTitle",statusSubmitted:"NegotiableQuote.Manage.bannerStatusMessages.submitted",statusPending:"NegotiableQuote.Manage.bannerStatusMessages.pending",statusExpired:"NegotiableQuote.Manage.bannerStatusMessages.expired",errorFallback:"NegotiableQuote.Manage.confirmationModal.delete.errorFallback",closeSuccessMessage:"NegotiableQuote.Manage.confirmationModal.close.successDescription",closeModalTitle:"NegotiableQuote.Manage.actionButtons.close",closeModalMessage:"NegotiableQuote.Manage.confirmationModal.close.message",closeModalCancel:"NegotiableQuote.Manage.confirmationModal.cancel",closeModalConfirm:"NegotiableQuote.Manage.confirmationModal.close.confirm",closeModalConfirmLoading:"NegotiableQuote.Manage.confirmationModal.close.confirmLoading",closeModalSuccessHeading:"NegotiableQuote.Manage.confirmationModal.close.successHeading",createTemplateModalTitle:"NegotiableQuote.Manage.actionButtons.createTemplate",createTemplateModalMessage:"NegotiableQuote.Manage.confirmationModal.createTemplate.message",createTemplateModalCancel:"NegotiableQuote.Manage.confirmationModal.cancel",createTemplateModalConfirm:"NegotiableQuote.Manage.confirmationModal.createTemplate.confirm",createTemplateModalConfirmLoading:"NegotiableQuote.Manage.confirmationModal.createTemplate.confirmLoading",createTemplateModalSuccessHeading:"NegotiableQuote.Manage.confirmationModal.createTemplate.successHeading",createTemplateSuccessMessage:"NegotiableQuote.Manage.confirmationModal.createTemplate.successDescription",createTemplateModalErrorHeading:"NegotiableQuote.Manage.confirmationModal.createTemplate.errorHeading",createTemplateErrorFallback:"NegotiableQuote.Manage.confirmationModal.createTemplate.errorFallback",renameErrorHeading:"NegotiableQuote.Manage.rename.errorHeading",renameQuoteNameRequired:"NegotiableQuote.Manage.rename.quoteNameRequired",renameErrorDefault:"NegotiableQuote.Manage.rename.errorDefault",renameSuccessHeading:"NegotiableQuote.Manage.rename.successHeading",renameSuccessMessage:"NegotiableQuote.Manage.rename.successMessage",confirmationModalCancel:"NegotiableQuote.Manage.confirmationModal.cancel",confirmationModalDeleteTitle:"NegotiableQuote.Manage.confirmationModal.delete.title",confirmationModalDeleteMessage:"NegotiableQuote.Manage.confirmationModal.delete.message",confirmationModalDeleteConfirm:"NegotiableQuote.Manage.confirmationModal.delete.confirm",confirmationModalDeleteErrorHeading:"NegotiableQuote.Manage.confirmationModal.delete.errorHeading",confirmationModalDeleteErrorFallback:"NegotiableQuote.Manage.confirmationModal.delete.errorFallback",confirmationModalDeleteSuccessHeading:"NegotiableQuote.Manage.confirmationModal.delete.successHeading",confirmationModalDeleteSuccessDescription:"NegotiableQuote.Manage.confirmationModal.delete.successDescription",confirmationModalDuplicateTitle:"NegotiableQuote.Manage.confirmationModal.duplicate.title",confirmationModalDuplicateMessage:"NegotiableQuote.Manage.confirmationModal.duplicate.message",confirmationModalDuplicateConfirm:"NegotiableQuote.Manage.confirmationModal.duplicate.confirm",confirmationModalDuplicateErrorHeading:"NegotiableQuote.Manage.confirmationModal.duplicate.errorHeading",confirmationModalDuplicateErrorFallback:"NegotiableQuote.Manage.confirmationModal.duplicate.errorFallback",confirmationModalDuplicateSuccessHeading:"NegotiableQuote.Manage.confirmationModal.duplicate.successHeading",confirmationModalDuplicateSuccessDescription:"NegotiableQuote.Manage.confirmationModal.duplicate.successDescription",noItemsSelectedModalTitle:"NegotiableQuote.Manage.confirmationModal.noItemsSelected.title",noItemsSelectedModalMessage:"NegotiableQuote.Manage.confirmationModal.noItemsSelected.message",noItemsSelectedModalConfirm:"NegotiableQuote.Manage.confirmationModal.noItemsSelected.confirm"});S(()=>{const n=D.on("quote-management/quote-data",r=>{const{quote:i}=r;i&&(f(i),y(!1))},{eager:!0});return()=>n==null?void 0:n.off()},[]),S(()=>{const n=D.on("quote-management/shipping-address-set",r=>{const{quote:i}=r;i&&f(i)},{eager:!0});return()=>n==null?void 0:n.off()},[]),S(()=>{const n=D.on("quote-management/quote-sent-for-review",r=>{const{quote:i}=r;f(i),be(""),ae(!1)},{eager:!0});return()=>n==null?void 0:n.off()},[]),S(()=>{const n=D.on("quote-management/quote-items-removed",r=>{const{quote:i,removedItemUids:g}=r;i&&f(i),g&&Ie(v=>{const je=new Set(v);return g.forEach(wa=>je.delete(wa)),je})},{eager:!0});return()=>n==null?void 0:n.off()},[]);const Re=c((n,r)=>{Ie(i=>{const g=new Set(i);return r?g.add(n.uid):g.delete(n.uid),g})},[]),xe=c(n=>{const r=n.target.value,i=Ee.current;if(r==="remove"){if(me(r),Z.current=r,i.size===0)Le(!0);else if(e&&se.current){const g=e.items.filter(v=>i.has(v.uid));se.current(g)}}N==null||N(n)},[N,e]),He=c(()=>{Le(!1),me(""),Z.current=""},[]);S(()=>{const n=D.on("quote-management/negotiable-quote-closed",async r=>{ne(!1),z(""),x(o.closeSuccessMessage),f(i=>{var g;return i!=null&&i.uid&&((g=r.closedQuoteUids)!=null&&g.includes(i.uid))&&Ua(i.uid).then(v=>{f(v)}).catch(v=>{console.warn("Failed to refresh quote data after closure:",v)}),i}),setTimeout(()=>{te(!1),x("")},2e3)},{eager:!0});return()=>n==null?void 0:n.off()},[o.closeSuccessMessage]),S(()=>{const n=D.on("quote-management/negotiable-quote-close-error",r=>{console.log("Close error event received:",r),ne(!1),x("");const i=r.error.message||o.errorFallback;z(i)},{eager:!0});return()=>n==null?void 0:n.off()},[o.errorFallback]),S(()=>{const n=D.on("quote-management/quote-renamed",r=>{const{quote:i}=r;f(i),P(""),H(""),Y(o.renameSuccessMessage),setTimeout(()=>{oe(!1),J(""),K(""),Y("")},2e3)},{eager:!0});return()=>n==null?void 0:n.off()},[o.renameSuccessMessage]),S(()=>{const n=D.on("quote-management/quote-duplicated",r=>{const{quote:i}=r;e&&q&&q({quoteData:e,newQuote:i}),R(!0),w(null),setTimeout(()=>{ee(!1),R(!1),w(null)},2e3)},{eager:!0});return()=>n==null?void 0:n.off()},[e,q]);const Fe=c(()=>{J((e==null?void 0:e.name)||""),K(""),P(""),H(""),Y(""),oe(!0)},[e]),ea=c(()=>{oe(!1),J(""),K(""),P(""),H(""),Y("")},[]),aa=c(n=>{J(n),n.trim()&&H("")},[]),Be=c(()=>{ee(!0),w(null),R(!1)},[]),ta=c(async()=>{if(!X.trim()){H(o.renameQuoteNameRequired);return}try{P(""),H(""),await Oa({quoteUid:e.uid,quoteName:X,quoteComment:re.trim()||void 0})}catch(n){P(n.message||o.renameErrorDefault)}},[e,X,re,o.renameQuoteNameRequired,o.renameErrorDefault]),na=p(()=>{const n=e&&(e.lockedForEditing===!0||e.lockedForEditing===void 0&&(e.status==="SUBMITTED"||e.status==="PENDING"||e.status==="ORDERED"||e.status==="CLOSED"));return a(u,{name:"QuoteName",slot:t==null?void 0:t.QuoteName,context:{quoteName:e==null?void 0:e.name,quoteData:e},children:d("div",{className:"quote-management-manage-negotiable-quote__quote-name-wrapper",children:[a("h1",{"data-testid":"quote-name",className:"quote-management-manage-negotiable-quote__quote-name-title",children:e==null?void 0:e.name}),a("button",{onClick:Fe,disabled:n,"data-testid":"rename-quote-button",className:"quote-management-manage-negotiable-quote__rename-button","aria-label":"Rename quote",children:a(Xa,{})})]})})},[t==null?void 0:t.QuoteName,e,Fe]),oa=p(()=>a(u,{name:"QuoteStatus",slot:t==null?void 0:t.QuoteStatus,context:{quoteStatus:e==null?void 0:e.status,quoteData:e},children:a("div",{"data-testid":"quote-status",children:e==null?void 0:e.status})}),[t==null?void 0:t.QuoteStatus,e]),ke=c(n=>{switch(n){case"SUBMITTED":return o.statusSubmitted;case"PENDING":return o.statusPending;case"EXPIRED":return o.statusExpired;default:return null}},[o])(e==null?void 0:e.status),Ue=ke&&a(h,{type:"warning",variant:"secondary",icon:a(U,{}),heading:o.bannerTitle,description:ke}),ra=Ue&&a(u,{name:"Banner","data-testid":"banner",slot:t==null?void 0:t.Banner,context:{quoteData:e},children:Ue}),ia=p(()=>{if(!e)return;const n=e.expirationDate?$e(e.expirationDate,"short"):void 0;return d(u,{name:"Details",slot:t==null?void 0:t.Details,context:{quoteData:e},children:[d("div",{className:"quote-management-manage-negotiable-quote__detail",children:[a("span",{className:"quote-management-manage-negotiable-quote__detail-title","data-testid":"created-label",children:o.createdLabel}),d("span",{className:"quote-management-manage-negotiable-quote__detail-content","data-testid":"created-value",children:[$e(e.createdAt,"short")," (",e.buyer.firstname," ",e.buyer.lastname,")"]})]}),d("div",{className:"quote-management-manage-negotiable-quote__detail",children:[a("span",{className:"quote-management-manage-negotiable-quote__detail-title","data-testid":"sales-rep-label",children:o.salesRepLabel}),a("span",{className:"quote-management-manage-negotiable-quote__detail-content","data-testid":"sales-rep-value",children:e.salesRepName})]}),d("div",{className:"quote-management-manage-negotiable-quote__detail",children:[a("span",{className:"quote-management-manage-negotiable-quote__detail-title","data-testid":"expires-label",children:o.expiresLabel}),a("span",{className:"quote-management-manage-negotiable-quote__detail-content","data-testid":"expires-value",children:n})]})]})},[t==null?void 0:t.Details,o,e]),Oe=p(()=>[{label:o.close,value:"close",disabled:!(e!=null&&e.canClose)},{label:o.delete,value:"delete",disabled:!(e!=null&&e.canDelete)},{label:o.print,value:"print"},{label:o.createTemplate,value:"createTemplate"},{label:o.createCopy,value:"createCopy"}],[o,e==null?void 0:e.canDelete,e==null?void 0:e.canClose]),la=p(()=>{const n=r=>{switch(r){case"close":te(!0),z(""),x(""),m==null||m(r);break;case"delete":_(!0),m==null||m(r);break;case"print":m==null||m(r);break;case"createTemplate":Te(!0),$(""),G(""),m==null||m(r);break;case"createCopy":Be(),m==null||m(r);break}};return a(u,{name:"ActionBar",slot:t==null?void 0:t.ActionBar,context:{quoteData:e,actionsBarDropdownValue:F},children:a(Ha,{dropdownPlaceholder:o.actionsLabel,dropdownOptions:[{label:o.remove,value:"remove"}],dropdownValue:F,handleDropdownChange:xe,buttons:Oe.map(r=>a(A,{variant:"tertiary",onClick:()=>n(r.value),"data-testid":`actions-bar-${r.value}-button`,"data-action":r.value,disabled:r.disabled,children:r.label},r.value))})})},[Oe,o,t==null?void 0:t.ActionBar,e,xe,m,Be,F]),ca=p(()=>a(u,{name:"QuoteContent",slot:t==null?void 0:t.QuoteContent,context:{quoteData:e},children:a(Fa,{tabs:new Map([["items-quoted","Items Quoted"],["comments","Comments"],["history-log","History Log"]]),tabsContent:new Map([["items-quoted",a(u,{name:"ItemsQuotedTab",slot:t==null?void 0:t.ItemsQuotedTab,context:{quoteData:e},children:a(Ga,{quoteData:e,onItemCheckboxChange:Re,onRemoveItemsRef:n=>{se.current=n},onRemoveModalStateChange:n=>{!n&&Z.current==="remove"&&me("")}})},"items-quoted")],["comments",a(u,{name:"CommentsTab",slot:t==null?void 0:t.CommentsTab,context:{quoteData:e},children:a($a,{quoteData:e})},"comments")],["history-log",a(u,{name:"HistoryLogTab",slot:t==null?void 0:t.HistoryLogTab,context:{quoteData:e},children:a(ka,{quoteData:e})},"history-log")]])})}),[t==null?void 0:t.QuoteContent,t==null?void 0:t.HistoryLogTab,t==null?void 0:t.CommentsTab,t==null?void 0:t.ItemsQuotedTab,e,Re]),sa=p(()=>a(u,{name:"ShippingInformationTitle",slot:t==null?void 0:t.ShippingInformationTitle,context:{quoteData:e},children:a("h2",{children:o.shippingInformationTitle})}),[t==null?void 0:t.ShippingInformationTitle,e,o]),ma=p(()=>a(u,{name:"ShippingInformation",slot:t==null?void 0:t.ShippingInformation,context:{quoteData:e,loading:T,setLoading:y},children:a(Ba,{quoteData:e,loading:T,"data-testid":"manage-quote-shipping-address"})}),[t==null?void 0:t.ShippingInformation,e,T,y]),da=p(()=>a(u,{name:"QuoteCommentsTitle",slot:t==null?void 0:t.QuoteCommentsTitle,context:{quoteData:e},children:a("h2",{children:o.quoteCommentsTitle})}),[t==null?void 0:t.QuoteCommentsTitle,o,e]),ua=p(()=>a(u,{name:"QuoteComments",slot:t==null?void 0:t.QuoteComments,context:{quoteData:e},children:a(Je,{name:"quoteComments",placeholder:o.quoteCommentsPlaceholder,rows:3,value:L,onInput:n=>{be(n.target.value)},disabled:!(e!=null&&e.canSendForReview)||O})}),[t==null?void 0:t.QuoteComments,o,e,L,O]),ga=c(async()=>{if(e!=null&&e.uid){ne(!0),z(""),x("");try{await za({quoteUids:[e.uid]})}catch(n){console.error("Failed to close quote:",n)}}},[e]),pa=c(()=>{te(!1),z(""),x("")},[]),fa=c(async()=>{if(e!=null&&e.uid){Ce(!0),$(""),G("");try{await Pa(e.uid),G(o.createTemplateSuccessMessage)}catch(n){console.error("Failed to create quote template:",n);const r=n instanceof Error?n.message:o.createTemplateErrorFallback;$(r)}finally{Ce(!1)}}},[e,o.createTemplateSuccessMessage,o.createTemplateErrorFallback]),Ma=c(()=>{Te(!1),$(""),G("")},[]),ze=c(async()=>{if(C){C({quoteData:e,comment:L.trim()||void 0});return}ae(!0);try{await Wa({quoteUid:e.uid,comment:L.trim()||void 0})}catch(n){console.error("Failed to send quote for review:",n),ae(!1)}},[e,C,L]),ba=p(()=>a(u,{name:"Footer",slot:t==null?void 0:t.Footer,context:{quoteData:e,comment:L,isSubmitting:O},children:a(A,{variant:"primary",onClick:ze,"data-testid":"send-for-review-button",disabled:!(e!=null&&e.canSendForReview)||O,children:o.sendForReview})}),[t==null?void 0:t.Footer,o,e,L,O,ze]),ha=p(()=>ie?a(h,{type:"error",variant:"primary",icon:a(U,{color:"var(--color-error)"}),heading:o.renameErrorHeading,description:ie}):void 0,[ie,o.renameErrorHeading]),Na=p(()=>le?a(h,{type:"success",variant:"primary",icon:a(V,{}),heading:o.renameSuccessHeading,description:le}):void 0,[le,o.renameSuccessHeading]),de=c(n=>n.errors&&Array.isArray(n.errors)&&n.errors.length>0?n.errors[0].message||o.confirmationModalDeleteErrorFallback:(n==null?void 0:n.message)||o.confirmationModalDeleteErrorFallback,[o.confirmationModalDeleteErrorFallback]),qa=c(()=>{_(!1),M(null),j(!1)},[]),Qa=c(async()=>{if(e!=null&&e.uid){M(null),j(!1);try{const{operationResults:n}=await Va(e.uid),r=n.find(i=>i.__typename==="DeleteNegotiableQuoteOperationFailure");if(r){const i=de(r);M(i);return}j(!0)}catch(n){const r=de(n);M(r)}}},[e,de]),Sa=c(()=>{M(null)},[]),Ta=c(()=>{j(!1)},[]),Pe=c(n=>(n==null?void 0:n.message)||o.confirmationModalDuplicateErrorFallback,[o.confirmationModalDuplicateErrorFallback]),va=c(()=>{ee(!1),w(null),R(!1)},[]),Ca=c(async()=>{if(e!=null&&e.uid){w(null),R(!1);try{const r=(i=>{const g=i.slice(0,-8),v=crypto.randomUUID().slice(0,8);return g+v})(e.uid);await ja({quoteUid:e.uid,duplicatedQuoteUid:r})}catch(n){const r=Pe(n);w(r)}}},[e,Pe]),ya=c(()=>{w(null)},[]),_a=c(()=>{R(!1)},[]),Da=Q?a(h,{type:"error",variant:"primary",icon:a(U,{}),heading:o.confirmationModalDeleteErrorHeading,description:Q,onDismiss:Sa,"data-testid":"confirmation-modal-error-banner"}):null,We=(Ye?a(h,{type:"success",variant:"primary",icon:a(V,{}),heading:o.confirmationModalDeleteSuccessHeading,description:o.confirmationModalDeleteSuccessDescription,onDismiss:Ta,"data-testid":"confirmation-modal-success-banner"}):null)||Da,Ia=Me?a(h,{type:"error",variant:"primary",icon:a(U,{}),heading:o.confirmationModalDuplicateErrorHeading,description:Me,onDismiss:ya,"data-testid":"confirmation-modal-duplicate-error-banner"}):null,Ve=(Ze?a(h,{type:"success",variant:"primary",icon:a(V,{}),heading:o.confirmationModalDuplicateSuccessHeading,description:o.confirmationModalDuplicateSuccessDescription,onDismiss:_a,"data-testid":"confirmation-modal-duplicate-success-banner"}):null)||Ia,Ea={...I,loading:T,quoteName:na,quoteStatus:oa,banner:ra||void 0,details:ia,actionBar:la,quoteContent:ca,shippingInformationTitle:sa,shippingInformation:ma,quoteCommentsTitle:da,quoteComments:ua,footer:ba};let ue=null;qe?ue=a(h,{type:"success",variant:"primary",icon:a(V,{}),heading:o.closeModalSuccessHeading,description:qe,"data-testid":"close-quote-success-banner"}):Qe&&(ue=a(h,{type:"error",variant:"primary",icon:a(U,{}),heading:o.confirmationModalDeleteErrorHeading,description:Qe,"data-testid":"close-quote-error-banner"}));let ge=null;return ye?ge=a(h,{type:"success",variant:"primary",icon:a(V,{}),heading:o.createTemplateModalSuccessHeading,description:ye,"data-testid":"create-template-success-banner"}):_e&&(ge=a(h,{type:"error",variant:"primary",icon:a(U,{}),heading:o.createTemplateModalErrorHeading,description:_e,"data-testid":"create-template-error-banner"})),d(Xe,{children:[a(Ja,{...Ea}),De&&B(a(Ya,{open:De,quoteName:X,renameReason:re,quoteNameError:Ae,errorBanner:ha,successBanner:Na,onQuoteNameChange:aa,onRenameReasonChange:K,onSave:ta,onClose:ea}),document.body),E&&B(a(W,{open:E,title:o.confirmationModalDeleteTitle,message:o.confirmationModalDeleteMessage,cancelLabel:o.confirmationModalCancel,confirmLabel:o.confirmationModalDeleteConfirm,onCancel:qa,onConfirm:Qa,showCloseButton:!We,confirmationBanner:We}),document.body),fe&&B(a(W,{open:fe,title:o.confirmationModalDuplicateTitle,message:o.confirmationModalDuplicateMessage,cancelLabel:o.confirmationModalCancel,confirmLabel:o.confirmationModalDuplicateConfirm,onCancel:va,onConfirm:Ca,showCloseButton:!Ve,confirmationBanner:Ve}),document.body),he&&B(a(W,{open:he,title:o.closeModalTitle,message:o.closeModalMessage,cancelLabel:o.closeModalCancel,confirmLabel:Ne?o.closeModalConfirmLoading:o.closeModalConfirm,onCancel:pa,onConfirm:Ne?void 0:ga,showCloseButton:!0,confirmationBanner:ue,"data-testid":"close-quote-confirmation-modal"}),document.body),Se&&B(a(W,{open:Se,title:o.createTemplateModalTitle,message:o.createTemplateModalMessage,cancelLabel:o.createTemplateModalCancel,confirmLabel:ve?o.createTemplateModalConfirmLoading:o.createTemplateModalConfirm,onCancel:Ma,onConfirm:ve?void 0:fa,showCloseButton:!0,confirmationBanner:ge,"data-testid":"create-template-confirmation-modal"}),document.body),we&&B(a(W,{open:we,title:o.noItemsSelectedModalTitle,message:o.noItemsSelectedModalMessage,confirmLabel:o.noItemsSelectedModalConfirm,onConfirm:He,onClose:He,showCloseButton:!0,"data-testid":"no-items-selected-modal"}),document.body)]})};export{Lt as ManageNegotiableQuote,Lt as default};
//# sourceMappingURL=ManageNegotiableQuote.js.map
